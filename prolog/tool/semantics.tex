\[
\begin{array}{r@{}c@{}l}
\Prule{\Tstep{\Tpar{P1}{Q1}}{\Tsay{A}{L}}{\Tpar{P2}{Q2}}}{\Tstep{P1}{\Tsay{A}{L}}{P2},\Tstep{Q1}{\Thear{A}{L}}{Q2}}.
\\\Prule{\Tstep{\Tpar{P1}{Q1}}{\Tsay{A}{L}}{\Tpar{P2}{Q2}}}{\Tstep{P1}{\Thear{A}{L}}{P2},\Tstep{Q1}{\Tsay{A}{L}}{Q2}}.
\\\Prule{\Tstep{\Tpar{P1}{Q1}}{\Thear{A}{L}}{\Tpar{P2}{Q2}}}{\Tstep{P1}{\Thear{A}{L}}{P2},\Tstep{Q1}{\Thear{A}{L}}{Q2}}.
\\\Prule{\Tstep{\Tpar{P1}{Q1}}{\Tdelta{T}}{\Tpar{P2}{Q2}}}{\Tstep{P1}{\Tdelta{T}}{P2},\Tstep{Q1}{\Tdelta{T}}{Q2}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{Xs}{\Trte_Enter{X}{K}}}{\Tsay{\Tx{X}{I}}{enter}}{\Trinst{\Tr{R}{I}}{C}{\Tcons{X}{Xs}}{\Tap{K}{ok}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{\Tcons{X}{Xs}}{\Trte_Exit{X}{K}}}{\Tsay{\Tx{X}{I}}{exit}}{\Trinst{\Tr{R}{I}}{C}{Xs}{\Tap{K}{ok}}}}.
\\\Pfact{\Tstep{\Texcl{\Tx{X}{I}}{free}}{\Thear{\Tx{X}{I}}{enter}}{\Texcl{\Tx{X}{I}}{taken}}}.
\\\Pfact{\Tstep{\Texcl{\Tx{X}{I}}{taken}}{\Thear{\Tx{X}{I}}{exit}}{\Texcl{\Tx{X}{I}}{free}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{Xs}{\Trte_IrvRead{S}{K}}}{\Tsay{\Ts{S}{I}}{\Tirvr{V}}}{\Trinst{\Tr{R}{I}}{C}{Xs}{\Tap{K}{V}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{Xs}{\Trte_IrvWrite{S}{K}}}{\Tsay{\Ts{S}{I}}{\Tirvw{_V}}}{\Trinst{\Tr{R}{I}}{C}{Xs}{\Tap{K}{ok}}}}.
\\\Pfact{\Tstep{\Tirv{\Ts{S}{I}}{V}}{\Thear{\Ts{S}{I}}{\Tirvr{V}}}{\Tirv{\Ts{S}{I}}{V}}}.
\\\Pfact{\Tstep{\Tirv{\Ts{S}{I}}{_}}{\Thear{\Ts{S}{I}}{\Tirvw{V}}}{\Tirv{\Ts{S}{I}}{V}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{Xs}{\Trte_Receive{\Te{E}{P}}{K}}}{\Tsay{\Tep{E}{P}{I}}{\Trcv{V}}}{\Trinst{\Tr{R}{I}}{C}{Xs}{\Tap{K}{V}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{Xs}{\Trte_Send{\Te{E}{P}}{V}{K}}}{\Tsay{\Tep{E}{P}{I}}{\Tsnd{V}{Res}}}{\Trinst{\Tr{R}{I}}{C}{Xs}{\Tap{K}{Res}}}}.
\\\Pfact{\Tstep{\Tqelem{\Tep{E}{P}{I}}{N}{\Tcons{V}{Vs}}}{\Thear{\Tep{E}{P}{I}}{\Trcv{V}}}{\Tqelem{\Tep{E}{P}{I}}{N}{Vs}}}.
\\\Pfact{\Tstep{\Tqelem{\Tep{E}{P}{I}}{N}{eps}}{\Thear{\Tep{E}{P}{I}}{\Trcv{no_data}}}{\Tqelem{\Tep{E}{P}{I}}{N}{eps}}}.
\\\Prule{\Tstep{\Tqelem{\Tep{E}{P}{I}}{N}{Vs}}{\Thear{A}{\Tsnd{V}{ok}}}{\Tqelem{\Tep{E}{P}{I}}{N}{\Tseq{Vs}{V}}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tless{\Tlength{Vs}}{N}}.
\\\Prule{\Tstep{\Tqelem{\Tep{E}{P}{I}}{N}{Vs}}{\Thear{A}{\Tsnd{_}{limit}}}{\Tqelem{\Tep{E}{P}{I}}{N}{Vs}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tequal{\Tlength{Vs}}{N}}.
\\\Prule{\Tstep{\Tqelem{\Tep{E}{P}{I}}{N}{Vs}}{\Thear{A}{\Tsnd{V}{limit}}}{\Tqelem{\Tep{E}{P}{I}}{N}{\Tseq{Vs}{V}}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tless{\Tlength{Vs}}{N}}.
\\\Prule{\Tstep{\Trunnable{\Tr{R}{I}}{K}{T}{_}{N}}{\Thear{A}{\Tsnd{_}{ok}}}{\Trunnable{\Tr{R}{I}}{K}{T}{pending}{N}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tevents{\Tr{R}{I}}{\TdataReceived{\Te{E}{P}}}}.
\\\Prule{\Tstep{\Trunnable{\Tr{R}{I}}{K}{T}{Act}{N}}{\Thear{A}{\Tsnd{_}{limit}}}{\Trunnable{\Tr{R}{I}}{K}{T}{Act}{N}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tevents{\Tr{R}{I}}{\TdataReceived{\Te{E}{P}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Read{\Te{E}{P}}{K}}}{\Tsay{\Tep{E}{P}{I}}{\Trd{V}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{V}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Write{\Te{E}{P}}{V}{K}}}{\Tsay{\Tep{E}{P}{I}}{\Twr{V}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{ok}}}}.
\\\Pfact{\Tstep{\Tdelem{\Tep{E}{P}{I}}{_}{V}}{\Thear{\Tep{E}{P}{I}}{\Trd{V}}}{\Tdelem{\Tep{E}{P}{I}}{false}{V}}}.
\\\Prule{\Tstep{\Tdelem{\Tep{E}{P}{I}}{_}{_}}{\Thear{A}{\Twr{V}}}{\Tdelem{\Tep{E}{P}{I}}{true}{V}}}{\Tconnect{A}{\Tep{E}{P}{I}}}.
\\\Prule{\Tstep{\Trunnable{\Tr{R}{I}}{K}{T}{_}{N}}{\Thear{A}{\Twr{_}}}{\Trunnable{\Tr{R}{I}}{K}{T}{pending}{N}}}{\Tconnect{A}{\Tep{E}{P}{I}},\Tevents{\Tr{R}{I}}{\TdataReceived{\Te{E}{P}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_IsUpdated{\Te{E}{P}}{K}}}{\Tsay{\Tep{E}{P}{I}}{\Tup{U}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{U}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Invalidate{\Te{E}{P}}{K}}}{\Tsay{\Tep{E}{P}{I}}{inv}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{ok}}}}.
\\\Pfact{\Tstep{\Tdelem{\Tep{E}{P}{I}}{U}{V}}{\Thear{\Tep{E}{P}{I}}{\Tup{U}}}{\Tdelem{\Tep{E}{P}{I}}{U}{V}}}.
\\\Prule{\Tstep{\Tdelem{\Tep{E}{P}{I}}{_U}{_}}{\Thear{A}{inv}}{\Tdelem{\Tep{E}{P}{I}}{true}{invalid}}}{\Tconnect{A}{\Tep{E}{P}{I}}}.
\\\Prule{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Call{\To{O}{P}}{V}{K}}}{\Tsay{\Top{O}{P}{I}}{\Tcall{V}{ok}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Result{\To{O}{P}}{K}}}}{\TserverCallPoint{\Tr{R}{I}}{\Tsync{\To{O}{P}}}}.
\\\Prule{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Call{\To{O}{P}}{V}{K}}}{\Tsay{\Top{O}{P}{I}}{\Tcall{V}{ok}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{Res}}}}{\TserverCallPoint{\Tr{R}{I}}{\Tasync{\To{O}{P}}}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Call{\To{O}{P}}{V}{K}}}{\Tsay{\Top{O}{P}{I}}{\Tcall{V}{limit}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{Res}}}}.
\\\Prule{\Tstep{\Trunnable{\Tr{R}{I}}{K}{T}{\Tserving{Cs}{Vs}}{N}}{\Thear{A}{\Tcall{V}{ok}}}{\Trunnable{\Tr{R}{I}}{K}{T}{\Tserving{\Tseq{Cs}{A}}{\Tseq{Vs}{V}}}{N}}}{\Tconnect{A}{\Top{O}{P}{I}},\Tevents{\Tr{R}{I}}{\ToperationInvoked{\To{O}{P}}},\Pnegate{\Tmember{A}{Cs}}}.
\\\Prule{\Tstep{\Trunnable{\Tr{R}{I}}{K}{T}{\Tserving{Cs}{Vs}}{N}}{\Thear{A}{\Tcall{_}{limit}}}{\Trunnable{\Tr{R}{I}}{K}{T}{\Tserving{Cs}{Vs}}{N}}}{\Tconnect{A}{\Top{O}{P}{I}},\Tevents{\Tr{R}{I}}{\ToperationInvoked{\To{O}{P}}},\Tmember{A}{Cs}}.
\\\Pfact{\Tstep{\Trinst{\Tr{R}{I}}{C}{XS}{\Trte_Result{\To{O}{P}}{K}}}{\Tsay{\Top{O}{P}{I}}{\Tres{V}}}{\Trinst{\Tr{R}{I}}{C}{XS}{\Tap{K}{V}}}}.
\\\Pfact{\Tstep{\Trinst{A}{\Top{O}{P}{I}}{eps}{\Treturn{V}}}{\Tsay{\Top{O}{P}{I}}{\Tret{V}}}{\Trinst{A}{nil}{eps}{\Treturn{void}}}}.
\\\Pfact{\Tstep{\Topres{\Top{O}{P}{I}}{\Tcons{V}{Vs}}}{\Thear{\Top{O}{P}{I}}{\Tres{V}}}{\Topres{\Top{O}{P}{I}}{Vs}}}.
\\\Pfact{\Tstep{\Topres{\Top{O}{P}{I}}{Vs}}{\Thear{\Top{O}{P}{I}}{\Tret{V}}}{\Topres{\Top{O}{P}{I}}{\Tseq{Vs}{V}}}}.
\\\Prule{\Tstep{\Topres{\Top{O}{P}{I}}{eps}}{\Thear{\Top{O}{P}{I}}{\Tres{no_data}}}{\Topres{\Top{O}{P}{I}}{eps}}}{\Tasync_result{\Top{O}{P}{I}}}.
\\\Pfact{\Tstep{\Trinst{A}{nil}{eps}{\Treturn{_}}}{\Tsay{A}{term}}{null}}.
\\\Pfact{\Tstep{\Trunnable{A}{K}{T}{Act}{N}}{\Thear{A}{term}}{\Trunnable{A}{K}{T}{Act}{\Tminus{N}{1}}}}.
\\\Prule{\Tstep{\Trunnable{A}{K}{0}{pending}{0}}{\Tsay{A}{new}}{\Tpar{\Trunnable{A}{K}{T}{idle}{1}}{\Trinst{A}{nil}{eps}{\Tap{K}{void}}}}}{\TminimumStartInterval{A}{T}}.
\\\Prule{\Tstep{\Trunnable{A}{K}{0}{pending}{N}}{\Tsay{A}{new}}{\Tpar{\Trunnable{A}{K}{T}{idle}{\Tplus{N}{1}}}{\Trinst{A}{nil}{eps}{\Tap{K}{void}}}}}{\TcanBeInvokedConcurrently{A},\TminimumStartInterval{A}{T}}.
\\\Prule{\Tstep{\Trunnable{A}{K}{0}{\Tserving{\Tcons{C}{Cs}}{\Tcons{V}{Vs}}}{0}}{\Tsay{A}{new}}{\Tpar{\Trunnable{A}{K}{T}{\Tserving{Cs}{Vs}}{1}}{\Trinst{A}{C}{eps}{\Tap{K}{V}}}}}{\TminimumStartInterval{A}{T}}.
\\\Prule{\Tstep{\Trunnable{A}{K}{0}{\Tserving{\Tcons{C}{Cs}}{\Tcons{V}{Vs}}}{N}}{\Tsay{A}{new}}{\Tpar{\Trunnable{A}{K}{T}{\Tserving{Cs}{Vs}}{\Tplus{N}{1}}}{\Trinst{A}{C}{eps}{\Tap{K}{V}}}}}{\TcanBeInvokedConcurrently{A},\TminimumStartInterval{A}{T}}.
\\\Prule{\Tstep{\Ttimer{A}{0}}{\Tsay{A}{tick}}{\Ttimer{A}{T}}}{\Tevents{A}{\Ttiming{T}}}.
\\\Pfact{\Tstep{\Trunnable{A}{K}{T}{_}{N}}{\Thear{A}{tick}}{\Trunnable{A}{K}{T}{pending}{N}}}.
\\\Prule{\Tstep{\Ttimer{A}{V}}{\Tdelta{T}}{\Ttimer{A}{\Tminus{V}{T}}}}{\Tlesseq{T}{V}}.
\\\Prule{\Tstep{\Trunnable{A}{K}{V}{Act}{N}}{\Tdelta{T}}{\Trunnable{A}{K}{\Tminus{V}{T}}{Act}{N}}}{\Tlesseq{T}{V}}.
\\\Pfact{\Tstep{\Trunnable{A}{K}{0}{Act}{N}}{\Tdelta{_}}{\Trunnable{A}{K}{0}{Act}{N}}}.
\\\Pfact{\Tstep{\Trinst{A}{C}{XS}{Code}}{\Tdelta{_}}{\Trinst{A}{C}{XS}{Code}}}.
\\\Pfact{\Tstep{\Texcl{A}{V}}{\Tdelta{_}}{\Texcl{A}{V}}}.
\\\Pfact{\Tstep{\Tirv{A}{V}}{\Tdelta{_}}{\Tirv{A}{V}}}.
\\\Pfact{\Tstep{\Tqelem{A}{N}{Vs}}{\Tdelta{_}}{\Tqelem{A}{N}{Vs}}}.
\\\Pfact{\Tstep{\Tdelem{A}{U}{V}}{\Tdelta{_}}{\Tdelem{A}{U}{V}}}.
\\\Pfact{\Tstep{\Topres{A}{Vs}}{\Tdelta{_}}{\Topres{A}{Vs}}}.
\\\Pfact{\Tstep{\Trinst{A}{C}{Xs}{K}}{\Thear{_}{_}}{\Trinst{A}{C}{Xs}{K}}}.
\\\Pfact{\Tstep{\Ttimer{B}{T}}{\Thear{_}{_}}{\Ttimer{B}{T}}}.
\\\Prule{\Tstep{\Trunnable{B}{K}{T}{Act}{N}}{\Thear{A}{_}}{\Trunnable{B}{K}{T}{Act}{N}}}{\Pnegate{\Tequal{A}{B}}}.
\\\Prule{\Tstep{\Texcl{B}{V}}{\Thear{A}{_}}{\Texcl{B}{V}}}{\Pnegate{\Tequal{A}{B}}}.
\\\Prule{\Tstep{\Tirv{B}{V}}{\Thear{A}{_}}{\Tirv{B}{V}}}{\Pnegate{\Tequal{A}{B}}}.
\\\Prule{\Tstep{\Tqelem{B}{N}{Vs}}{\Thear{A}{_}}{\Tqelem{B}{N}{Vs}}}{\Pnegate{\Tequal{A}{B}},\Pnegate{\Tconnect{A}{B}}}.
\\\Prule{\Tstep{\Tdelem{B}{U}{V}}{\Thear{A}{_}}{\Tdelem{B}{U}{V}}}{\Pnegate{\Tequal{A}{B}},\Pnegate{\Tconnect{A}{B}}}.
\\\Prule{\Tstep{\Topres{B}{Vs}}{\Thear{A}{_}}{\Topres{B}{Vs}}}{\Pnegate{\Tequal{A}{B}},\Pnegate{\Tconnect{A}{B}}}.
\\\end{array}
\]
